<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Orders</title>
</head>
<body>
    <h2>All Orders</h2>
    
    <table border="1">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Customer Name</th>
                <th>Customer Email</th>
                <th>Items</th>
                <th>Total Amount</th>
                <th>Status</th>
                <th>Time To Prepare</th>
                <th>Transaction ID</th>
                <th>Created At</th>
                <th>Updated At</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td> {{ order["order_id"] }} </td> <!-- MongoDB ObjectId, you can convert to string in your view function if needed -->
                <td> {{ order["customer"].name }} </td> <!-- Convert customerId to string if needed -->
                <td>{{ order["customer"]["email"] }}</td>
                <td>
                   <ul>
                        {% for item in order["items"] %}
                        <li>{{ item["name"] }} - ₹{{ item["price"]}}  Quantity: {{ item["quantity"] }}</li>
                        {% endfor %}
                    </ul>
                </td>
                <td>₹{{ order["totalAmount"] }}</td>
                <td>
                    <form action="/update_order_status/{{ order['order_id'] }}" method="POST">
                        <select name="status" required>
                            <option value="Pending" {% if order.status == "Pending" %}selected{% endif %}>Pending</option>
                            <option value="Preparing" {% if order.status == "Preparing" %}selected{% endif %}>Preparing</option>
                            <option value="Completed" {% if order.status == "Completed" %}selected{% endif %}>Completed</option>
                            <option value="Cancelled" {% if order.status == "Cancelled" %}selected{% endif %}>Cancelled</option>
                        </select>
                        <button type="submit">Update</button>
                    </form>
                </td>
                <td>{{ order["timeToPrepare"] }} mins</td>
                <td>{{ order["transactionId"] }}</td>
                <td>{{ order["createdAt"]  }}</td> <!-- Format date -->
                <td>{{ order["updatedAt"] }}</td> <!-- Format date -->
                
                
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>
